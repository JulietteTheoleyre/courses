---
title: Graphics and maps with R - Part2
subtitle: Under Hadley Wickham's reign
author: Marie-Pierre Etienne
date: "2020/09/11 (updated: `r Sys.Date()`)"
institute: "https://github.com/MarieEtienne/stateoftheRinRennes/"
csl: "../resources/apa-no-doi-no-issue.csl"
output:
  beamer_presentation:
    slide_level: 3
    highlight: kate
    keep_tex: true
    includes:
      in_header: ../resources/common_preamble.tex
      before_body: ../resources/common_startup.tex
bibliography: visu.bib
fontsize: 10pt
params: 
  child_path : ""
  setup_path : "../resources/"
---
```{r setup, include=FALSE}
source(paste0(params$setup_path, "knitr_setup.R"))
with_sol <- TRUE ## in order to control the output
with_course <- TRUE
```


# From spherical object to maps

## Coordinate Reference system (CRS)

### Geodetic datum (or geodetic system) 

An  approximation of sea level on Earth contains:

- the definition of the chosen ellipsoide
- a geodetic datum on Earth 

![Geodetic datum (source https://commons.wikimedia.org/wiki/File:Azimutalprojektion-schief_kl.jpg, author:	Stefan KÃ¼hn,  Fotograf ) ](img/1280px-ECEF.png){height=40%}

At global scale  *World Geodetic System* (WGS84) is the reference geodetic datum for GPS 



### Projected CRS

- Cartesian coordinates on  flat surface,
- based on a geodetic datum
- rely on on map projection to convert the 3d surface on Earth into Eastings and Northings (x and y)



### Examples

The informations on the CRS used by a spatial object has ti be stored with the object

```{r CRS_illustration}
library("sf")
library("rnaturalearth")
library("rnaturalearthdata")

world <- ne_countries(scale = "medium", returnclass = "sf")
st_crs(world$geometry)
```

# Data types

## Vector data

### Representing geographic information

- Vector data are collections of points,  lines, polygons (potentially connected). 
- Many different objects in `R` deals with spatial data. \par \alert{focus on ` sf`  objects}

Simple features (`sf`) is an [open standard](https://www.ogc.org/standards/sfa) for spatial object with hierarchical structure. The `sf` package provides
- efficient access to data (writing and reading)
- easy and fancy plotting
- `sf` objects can be used as `data.frame`

### `sf` objects example

```{r sf_world_example}
world %>% select(admin, income_grp, wikipedia, economy, geometry) %>% print(n=5)
```
### `sf` objects example

```{r sf_world_example}
world %>% ggplot() + geom_sf()
```

### Geometry types

- Vector data are collections of points,  lines, polygons (potentially connected). 
- Many different objects in `R` deals with spatial data. \par \alert{focus on ` sf`  objects}

Simple features (`sf`) is an [open standard](https://www.ogc.org/standards/sfa) for spatial object with hierarchical structure. The `sf` package provides
- efficient access to data (writing and reading)
- easy and fancy plotting
- `sf` objects can be used as `data.frame`


<!--  ```{r Rennes_geography, echo = FALSE} -->
<!--  city_hall <- st_point(c(-1.679163, 48.111366)) -->
<!--  st_crs(city_hall) <- 4326 -->
<!-- ``` -->

- Points : the location of the city hall in Rennes ( latitu 

